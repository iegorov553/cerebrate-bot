# –ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–π –º–∏–≥—Ä–∞—Ü–∏–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

## –û–±–∑–æ—Ä

–î–∞–Ω–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –æ–ø–∏—Å—ã–≤–∞–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–π –º–∏–≥—Ä–∞—Ü–∏–∏ `00000000000000_complete_schema_recreation.sql`, –∫–æ—Ç–æ—Ä–∞—è —Å–æ–∑–¥–∞–µ—Ç –ø–æ–ª–Ω—É—é —Å—Ö–µ–º—É –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –¥–ª—è Doyobi Diary Bot –∏–∑ –Ω—É–ª—è.

## –ß—Ç–æ –≤–∫–ª—é—á–∞–µ—Ç –º–∏–≥—Ä–∞—Ü–∏—è

### üìä –ë–∞–∑–æ–≤—ã–µ —Ç–∞–±–ª–∏—Ü—ã
- **`users`** - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –∏ —è–∑—ã–∫–æ–≤—ã–º–∏ –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏—è–º–∏
- **`tg_jobs`** - –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –ø—Ä–∏–≤—è–∑–∫–æ–π –∫ –∫–∞—Å—Ç–æ–º–Ω—ã–º –≤–æ–ø—Ä–æ—Å–∞–º

### ü§ù –°–æ—Ü–∏–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏  
- **`friendships`** - –¥—Ä—É–∂–µ—Å–∫–∏–µ –æ—Ç–Ω–æ—à–µ–Ω–∏—è —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –¥—Ä—É–∑—å—è
- **`user_questions`** - —Å–∏—Å—Ç–µ–º–∞ –∫–∞—Å—Ç–æ–º–Ω—ã—Ö –≤–æ–ø—Ä–æ—Å–æ–≤ —Å –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ–º
- **`question_notifications`** - –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –¥–ª—è Telegram Reply

### ‚ö° –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- **15+ –∏–Ω–¥–µ–∫—Å–æ–≤** –¥–ª—è –±—ã—Å—Ç—Ä—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- **5 —Ñ—É–Ω–∫—Ü–∏–π –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏** –¥–ª—è —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è N+1 –∑–∞–ø—Ä–æ—Å–æ–≤
- **RLS –ø–æ–ª–∏—Ç–∏–∫–∏** –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### üß™ –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
- 4 —Ç–µ—Å—Ç–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–∞ —Ä–∞–∑–Ω—ã—Ö —è–∑—ã–∫–∞—Ö
- –î–µ—Ñ–æ–ª—Ç–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –¢–µ—Å—Ç–æ–≤—ã–µ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –∏ –¥—Ä—É–∂–µ—Å–∫–∏–µ —Å–≤—è–∑–∏

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### 1. –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–∏

**–í –Ω–æ–≤–æ–π —Å—Ä–µ–¥–µ (—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ):**
```bash
# –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é –Ω–∞–ø—Ä—è–º—É—é
supabase db reset
# –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Ñ–∞–π–ª –º–∏–≥—Ä–∞—Ü–∏–∏ –∫–∞–∫ —Å–∞–º—É—é –ø–µ—Ä–≤—É—é
# –ò–º—è —Ñ–∞–π–ª–∞ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å 00000000000000_ –¥–ª—è –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞
supabase db push
```

**–í —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π —Å—Ä–µ–¥–µ (–æ—Å—Ç–æ—Ä–æ–∂–Ω–æ!):**
```bash
# –ù–ï –ø—Ä–∏–º–µ–Ω—è–π—Ç–µ –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ –±–µ–∑ backup!
# –≠—Ç–∞ –º–∏–≥—Ä–∞—Ü–∏—è –ø–µ—Ä–µ—Å–æ–∑–¥–∞–µ—Ç —Å—Ö–µ–º—É –ø–æ–ª–Ω–æ—Å—Ç—å—é
```

### 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç
python3 scripts/test_migration.py
```

–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:
```
üß™ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï –ö–û–ú–ü–õ–ï–ö–°–ù–û–ô –ú–ò–ì–†–ê–¶–ò–ò DOYOBI DIARY BOT
============================================================

üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è —Ç–∞–±–ª–∏—Ü...
  ‚úÖ users
  ‚úÖ tg_jobs
  ‚úÖ friendships
  ‚úÖ user_questions
  ‚úÖ question_notifications
‚úÖ –í—Å–µ 5 —Ç–∞–±–ª–∏—Ü —Å–æ–∑–¥–∞–Ω—ã —É—Å–ø–µ—à–Ω–æ

üöÄ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ—É–Ω–∫—Ü–∏–π –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏...
  ‚úÖ exec_sql
  ‚úÖ get_friend_requests_optimized
  ‚úÖ get_friends_list_optimized
  ‚úÖ get_friends_of_friends_optimized
  ‚úÖ get_user_stats
  ‚úÖ cleanup_expired_notifications
‚úÖ –í—Å–µ 6 —Ñ—É–Ω–∫—Ü–∏–π —Å–æ–∑–¥–∞–Ω—ã —É—Å–ø–µ—à–Ω–æ

üìà –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–Ω–¥–µ–∫—Å–æ–≤...
  ‚úÖ users.idx_users_last_notification_sent
  ‚úÖ users.idx_users_language
  ‚úÖ tg_jobs.idx_tg_jobs_tg_id
  ‚úÖ tg_jobs.idx_tg_jobs_question
  ‚úÖ friendships.idx_friendships_requester
  ‚úÖ friendships.idx_friendships_addressee
  ‚úÖ user_questions.idx_user_questions_default
  ‚úÖ user_questions.idx_user_questions_user_active
‚úÖ –í—Å–µ–≥–æ –∏–Ω–¥–µ–∫—Å–æ–≤ —Å–æ–∑–¥–∞–Ω–æ: 25+
‚úÖ –í—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã–µ –∏–Ω–¥–µ–∫—Å—ã –Ω–∞ –º–µ—Å—Ç–µ

üë• –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö...
  ‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: 4
  ‚úÖ –í–æ–ø—Ä–æ—Å–æ–≤: 4 (–¥–µ—Ñ–æ–ª—Ç–Ω—ã—Ö: 4)
  ‚úÖ –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç–µ–π: 4 (—Å –ø—Ä–∏–≤—è–∑–∫–æ–π –∫ –≤–æ–ø—Ä–æ—Å–∞–º: 4)
  ‚úÖ –î—Ä—É–∂–µ—Å–∫–∏—Ö —Å–≤—è–∑–µ–π: 3
‚úÖ –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ —Å–æ–∑–¥–∞–Ω—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

‚ö° –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–π –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏...
  ‚úÖ get_user_stats: 4 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, 4 –∞–∫—Ç–∏–≤–Ω—ã—Ö
  ‚úÖ get_friends_list_optimized: 1 –¥—Ä—É–∑–µ–π
  ‚úÖ get_friend_requests_optimized: 2 –∑–∞–ø—Ä–æ—Å–æ–≤
  ‚úÖ get_friends_of_friends_optimized: 0 —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π
‚úÖ –í—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

üîí –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π...
  ‚úÖ –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –Ω–∞ —è–∑—ã–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç
  ‚úÖ –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –Ω–∞ –¥—Ä—É–∂–±—É —Å —Å–æ–±–æ–π —Ä–∞–±–æ—Ç–∞–µ—Ç
  ‚úÖ –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –Ω–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª —Ä–∞–±–æ—Ç–∞–µ—Ç
‚úÖ –í—Å–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

============================================================
üìä –†–ï–ó–£–õ–¨–¢–ê–¢–´ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Ø: 6/6 —Ç–µ—Å—Ç–æ–≤ –ø—Ä–æ–π–¥–µ–Ω–æ
üéâ –í–°–ï –¢–ï–°–¢–´ –ü–†–û–ô–î–ï–ù–´ –£–°–ü–ï–®–ù–û!
‚úÖ –ú–∏–≥—Ä–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
```

### 3. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–π

–ü–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –º–∏–≥—Ä–∞—Ü–∏–∏ –º–æ–∂–Ω–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏ –Ω–∞–ø—Ä—è–º—É—é:

```sql
-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
SELECT * FROM get_user_stats();

-- –î—Ä—É–∑—å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
SELECT * FROM get_friends_list_optimized(123456789);

-- –ó–∞–ø—Ä–æ—Å—ã –≤ –¥—Ä—É–∑—å—è
SELECT * FROM get_friend_requests_optimized(123456789);

-- –ü–æ–∏—Å–∫ –¥—Ä—É–∑–µ–π –¥—Ä—É–∑–µ–π
SELECT * FROM get_friends_of_friends_optimized(123456789, 5);

-- –û—á–∏—Å—Ç–∫–∞ –∏—Å—Ç–µ–∫—à–∏—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
SELECT cleanup_expired_notifications();
```

## –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ

–ú–∏–≥—Ä–∞—Ü–∏—è —Å–æ–∑–¥–∞–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ:

### –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
- **123456789** - test_user1 (—Ä—É—Å—Å–∫–∏–π)
- **123456790** - test_user2 (–∞–Ω–≥–ª–∏–π—Å–∫–∏–π) 
- **123456791** - usuario_prueba (–∏—Å–ø–∞–Ω—Å–∫–∏–π)
- **123456792** - admin_user (—Ä—É—Å—Å–∫–∏–π)

### –î—Ä—É–∂–µ—Å–∫–∏–µ —Å–≤—è–∑–∏
- test_user1 ‚Üî test_user2 (–ø—Ä–∏–Ω—è—Ç–æ)
- test_user1 ‚Üê usuario_prueba (–æ–∂–∏–¥–∞–µ—Ç)
- test_user1 ‚Üê admin_user (–æ–∂–∏–¥–∞–µ—Ç)

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ —Ç–µ—Å—Ç–∞—Ö

```python
# –í Python —Ç–µ—Å—Ç–∞—Ö –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å
TEST_USER_1 = 123456789
TEST_USER_2 = 123456790
TEST_USER_ES = 123456791
TEST_ADMIN = 123456792
```

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è

### ‚ö†Ô∏è –í–ê–ñ–ù–û: –ù–ï –ø—Ä–∏–º–µ–Ω—è–π—Ç–µ –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ!

–≠—Ç–∞ –º–∏–≥—Ä–∞—Ü–∏—è **–ü–û–õ–ù–û–°–¢–¨–Æ –ü–ï–†–ï–°–û–ó–î–ê–ï–¢** —Å—Ö–µ–º—É –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:
- –£–¥–∞–ª—è–µ—Ç –≤—Å–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ
- –°–æ–∑–¥–∞–µ—Ç —Å—Ö–µ–º—É —Å –Ω—É–ª—è
- –î–æ–±–∞–≤–ª—è–µ—Ç —Ç–æ–ª—å–∫–æ —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

1. **–î–ª—è –Ω–æ–≤—ã—Ö —Å—Ä–µ–¥** (—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ, —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞):
   ```bash
   # –ë–µ–∑–æ–ø–∞—Å–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å
   supabase db reset
   # –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é
   ```

2. **–î–ª—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Å—Ä–µ–¥**:
   ```bash
   # –ù–ï –î–ï–õ–ê–ô–¢–ï –≠–¢–û–ì–û –±–µ–∑ backup!
   # –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–æ–ª—å–∫–æ –ø–æ—ç—Ç–∞–ø–Ω—ã–µ –º–∏–≥—Ä–∞—Ü–∏–∏
   ```

3. **–î–ª—è CI/CD —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è**:
   ```bash
   # –û—Ç–ª–∏—á–Ω–æ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Ç–µ—Å—Ç–æ–≤
   # –°–æ–∑–¥–∞–µ—Ç —á–∏—Å—Ç—É—é —Å—Ä–µ–¥—É —Å –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
   ```

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –º–∏–≥—Ä–∞—Ü–∏–∏

```
00000000000000_complete_schema_recreation.sql
‚îú‚îÄ‚îÄ 1. –ë–∞–∑–æ–≤—ã–µ —Ç–∞–±–ª–∏—Ü—ã (users, tg_jobs)
‚îú‚îÄ‚îÄ 2. –°–æ—Ü–∏–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ (friendships)
‚îú‚îÄ‚îÄ 3. –°–∏—Å—Ç–µ–º–∞ –∫–∞—Å—Ç–æ–º–Ω—ã—Ö –≤–æ–ø—Ä–æ—Å–æ–≤
‚îú‚îÄ‚îÄ 4. –ò–Ω–¥–µ–∫—Å—ã –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏  
‚îú‚îÄ‚îÄ 5. –í–Ω–µ—à–Ω–∏–µ –∫–ª—é—á–∏
‚îú‚îÄ‚îÄ 6. RLS –ø–æ–ª–∏—Ç–∏–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
‚îú‚îÄ‚îÄ 7. –§—É–Ω–∫—Ü–∏–∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ (N+1 queries)
‚îú‚îÄ‚îÄ 8. –ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ —Ñ—É–Ω–∫—Ü–∏—è–º
‚îú‚îÄ‚îÄ 9. –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –¥–ª—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏
‚îú‚îÄ‚îÄ 10. –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
‚îî‚îÄ‚îÄ 11. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏
```

## –°–≤—è–∑–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

- **`scripts/test_migration.py`** - —Å–∫—Ä–∏–ø—Ç –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –º–∏–≥—Ä–∞—Ü–∏–∏
- **`supabase_migrations/migrations/`** - –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–µ –ø–æ—ç—Ç–∞–ø–Ω—ã–µ –º–∏–≥—Ä–∞—Ü–∏–∏
- **`CLAUDE.md`** - —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞

## –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –û—à–∏–±–∫–∞: "—Ç–∞–±–ª–∏—Ü–∞ —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç"
```bash
# –û—á–∏—Å—Ç–∏—Ç–µ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
supabase db reset
# –ü—Ä–∏–º–µ–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏—é –∑–∞–Ω–æ–≤–æ
```

### –û—à–∏–±–∫–∞: "—Ñ—É–Ω–∫—Ü–∏—è —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç"
```sql
-- –£–¥–∞–ª–∏—Ç–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏
DROP FUNCTION IF EXISTS get_friends_list_optimized(BIGINT);
-- –ò –ø—Ä–∏–º–µ–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏—é –∑–∞–Ω–æ–≤–æ
```

### –¢–µ—Å—Ç—ã –Ω–µ –ø—Ä–æ—Ö–æ–¥—è—Ç
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
echo $SUPABASE_URL
echo $SUPABASE_SERVICE_ROLE_KEY

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
python3 -c "from bot.database.client import get_supabase_client; print('OK')"
```

## –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –º–∏–≥—Ä–∞—Ü–∏–∏ –≤ Supabase Dashboard
2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ `python3 scripts/test_migration.py` –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ service role key (–Ω–µ anon key)
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —Å—Ö–µ–º–∞ `public` –¥–æ—Å—Ç—É–ø–Ω–∞ –¥–ª—è –∑–∞–ø–∏—Å–∏